MP3（正式名称 MPEG-1 Audio Layer III，或者 MPEG-2 Layer III）是 1995 年定案、1998 年彻底统治世界的“一代传奇”音频格式。虽然现在已经被 AAC 全面超越，但它在 128kbps 时代拯救了全人类的硬盘和带宽，功不可没。

下面用最直白的方式给你讲清楚：**MP3 编码器到底是怎么把 PCM 变成那几百 KB 的 .mp3 文件的**（以经典的 LAME 编码器为准，所有现代 MP3 都走这条路）。

### MP3 编码完整流水线（1995 年版 vs 2025 年实际）

```
PCM（时域波形）
   ↓
1. 分成 576 或 1152 样本一帧（约 26ms @ 44.1kHz）
   ↓
2. 多相滤波器组（Polyphase Filterbank）
   ↓
3. 变成 32 个子带（粗糙的频谱）
   ↓
4. 同时用 MDCT（可切换长块 18×32 或短块 6×32）
   ↓
5. 得到 576 条更精细的频线（真正决定音质）
   ↓
6. 心理声学模型 II（Model 2）——MP3 的核心灵魂
   ↓
7. 计算每一帧每一频段的“掩蔽阈值”（人耳听不到的东西）
   ↓
8. 迭代比特分配 + 量化（核心循环，最费 CPU）
   ↓
9. 霍夫曼熵编码（把量化后的数字压成极小的二进制）
   ↓
10. 打包侧信息（scale factor、huffman table 选择等）
   ↓
.mp3 码流
```

### 关键步骤通俗解释（你必须知道的 5 个“黑科技”）

| 步骤                     | 干了什么                                   | 为什么省码率/影响音质                              |
|--------------------------|--------------------------------------------|----------------------------------------------------|
| 1. 多相滤波器组（Polyphase） | 先把信号粗暴分成 32 个等宽子带             | 让后面的心理声学模型好算，MP3 专利核心之一         |
| 2. 混合 MDCT（长/短块切换）  | 平稳段用长块（18 个样本→高频率分辨率）<br>打击乐用 3 组短块（6 个样本→高时间分辨率） | 避免预回声（pre-echo），这是 MP3 比 Layer II 强的地方 |
| 3. 心理声学模型 II          | 同时计算：音调掩蔽（tonal masking）、噪声掩蔽、安静阈值、时间掩蔽 | 精确算出“人耳完全听不见的能量”，直接扔掉          |
| 4. 迭代比特分配 + 量化      | 先给每个频段分配很少的 bit → 听是否有失真 → 再加 bit，直到刚好听不出或用完比特池 | 这步最费 CPU，LAME 花了 20 年才把这步调到极致     |
| 5. 霍夫曼编码               | 把量化后的数字用霍夫曼表压成极短的二进制   | 最后一步“打包行李”，省 20~30% 码率                |

### MP3 vs AAC 核心技术差距（为什么 MP3 输了）

| 项目                 | MP3（1995）                  | AAC（1997~1999）                  | 谁赢了 |
|----------------------|------------------------------|-----------------------------------|--------|
| 滤波器组             | 32 子带多相滤波器            | 纯 MDCT（1024/960 点）            | AAC    |
| 频率分辨率           | 576 条频线                   | 1024 条频线                       | AAC    |
| 短块时间分辨率       | 3 组短块（约 4ms）           | 8 组短块（约 2.6ms）              | AAC    |
| TNS（时域噪声整形）  | 没有                         | 有，极大减少预回声                | AAC    |
| 心理声学模型         | Model 1 / Model 2            | 更先进的 Model + 精确掩蔽曲线     | AAC    |
| 立体声编码           | M/S 或 Intensity             | M/S + Intensity + 参数立体声(PS)  | AAC    |
| 128kbps 主观音质     | 有明显金属感、预回声         | 接近透明                          | AAC 完胜 |

### 经典 MP3 码率与真实听感（2025 年视角）

| 码率         | LAME 推荐参数         | 实际听感（2025 年耳朵）               |
|--------------|------------------------|----------------------------------------|
| 320kbps      | -b 320                 | 几乎透明，只有黄金耳能挑出一点毛刺     |
| 256kbps      | -V0 或 -b 256          | 99% 的人听不出问题                     |
| 192kbps      | -V2                    | 大多数人 OK，打击乐开始有点预回声      |
| 128kbps      | -V5 或 -b 128          | 明显金属声、水声、预回声，基本放弃     |
| ≤96kbps      | 基本不用               | 完全不能听                             |

### 2025 年 MP3 的真实地位
- 仍然是**唯一几乎所有硬件都支持**的格式（车载、老音箱、U盘）
- 音乐发行已经基本退出（Spotify、Apple Music 都用 AAC）
- 唯一活得好的场景：**320kbps MP3 仍然是很多老发烧友的“终极存档格式”**，因为兼容性无敌

一句话总结：
MP3 是 1995 年用“32 子带 + 576 条频线 + 迭代比特分配”这套组合拳，打出了 10:1 压缩比的神话；  
AAC 只用了 10 年后，就用“纯 MDCT + TNS + 更好的立体声”把它彻底干翻了。

但你要知道：**今天你电脑里 99% 的 .mp3 文件，编码器还是 20 年前的 LAME**，它已经把 MP3 这套 30 年前的技术，优化到了物理极限，再也榨不出一点音质了。  
所以 MP3 输给 AAC，不是它不够强，而是它已经强到了时代的天花板。