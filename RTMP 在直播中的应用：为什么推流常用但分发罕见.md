

RTMP（Real-Time Messaging Protocol，实时消息协议）是一种由 Adobe 开发的流媒体协议，最初设计用于 Flash Player 传输音频、视频和数据。尽管 Flash 已于 2020 年底正式停止支持，但 RTMP 在 2025 年仍广泛用于直播的**推流（ingestion）**阶段，即从内容创建者（主播）将媒体流推送至服务器的过程。然而，在**分发（distribution）**阶段，即服务器将流交付给观众时，RTMP 已基本被取代，转而使用更现代的协议如 HLS（HTTP Live Streaming）、DASH（Dynamic Adaptive Streaming over HTTP）或 WebRTC。下面我将详细解释这一现象的原因，基于技术演进、兼容性和行业实践。

#### 1. **RTMP 在推流中的优势与持续使用原因**
RTMP 作为推流协议的流行源于其设计特性，使其特别适合实时媒体上传：

- **低延迟和实时性**：RTMP 基于 TCP 的持久连接，能够实现亚秒级延迟（通常 <1 秒），这对直播推流至关重要。主播可以通过编码软件如 OBS Studio 或 Wirecast 轻松推送流，而无需担心频繁的重连或缓冲中断。 这使得 RTMP 成为 Twitch、YouTube Live 等平台的标准摄取协议，即使在 2025 年，这些平台仍依赖它来处理来自全球主播的实时输入。

- **广泛兼容性和生态支持**：许多硬件编码器、软件工具和 CDN（内容分发网络）服务（如 AWS MediaLive、Akamai）原生支持 RTMP。作为行业标准，它简化了集成过程。例如，主播只需一个 RTMP URL 和密钥即可连接服务器，而无需复杂的配置。 尽管有更新的替代品如 SRT（Secure Reliable Transport）或 WebRTC，RTMP 的成熟生态让它在推流端难以被完全取代，尤其在专业直播环境中。

- **稳定性与简单性**：RTMP 支持元数据注入（如视频分辨率、帧率）和基本 QoS（服务质量）控制，适合从移动设备或 PC 推送流。增强版 RTMP（eRTMP）进一步改进了安全性，添加了加密支持。

总之，推流阶段强调从源头到服务器的快速、可靠传输，RTMP 的这些特性使其在 2025 年仍占主导地位，许多平台视其为“通用摄取标准”。

#### 2. **为什么分发阶段不使用 RTMP**
在分发端，RTMP 的局限性暴露无遗，导致它被更先进的协议取代。主要原因包括：

- **浏览器和设备兼容性问题**：RTMP 原本依赖 Flash Player 进行播放，但 Flash 已于 2020 年被浏览器废弃（如 Chrome、Safari）。现代 web 浏览器不支持原生 RTMP 播放，需要额外插件或转换，这在移动端（如 iOS、Android）尤为不便。 相反，HLS 和 DASH 基于 HTTP 协议，能无缝集成到 HTML5 视频标签中，支持自适应比特率（ABR），根据观众网络自动调整质量。

- **大规模分发不友好**：RTMP 是基于 TCP 的点对点协议，不适合通过 CDN 分发到数百万观众。它缺乏对缓存和边缘计算的优化，容易导致高服务器负载和瓶颈。 而 HLS/DASH 将流切分为小段文件（TS 或 MP4 片段），便于 CDN 缓存和全球分发，降低成本并提高可靠性。低延迟变体如 LL-HLS（Low-Latency HLS）已将延迟降至 2-5 秒，接近 RTMP。

- **安全性和现代需求不足**：RTMP 的原生版本缺乏强加密，易受中间人攻击。虽有 RTMPS（加密版），但不如 SRT 或 WebRTC 安全，后者支持 DTLS/SRTP。 此外，分发需考虑移动优先、跨平台和互动性（如 WebRTC 的 P2P 支持），RTMP 在这些方面落后。

- **行业趋势与替代方案**：从 2010 年代起，HTTP 流媒体协议主导分发。YouTube 和 Netflix 等平台摄取 RTMP 后，转码为 HLS/DASH。 对于超低延迟需求，WebRTC 或 SRT 已成为首选，尤其在互动直播（如游戏或拍卖）中。

#### 3. **典型直播工作流示例**
在现代直播系统中（如 Bilibili 或 Douyin）：
- **推流**：主播用 RTMP 将流推到媒体服务器（e.g., Nginx-RTMP 或 SRS）。
- **处理**：服务器转码、添加水印或混合多流。
- **分发**：转换为 HLS/DASH，通过 CDN 交付给观众。观众在浏览器或 App 中播放，无需特殊插件。

这种“RTMP 摄取 + HTTP/WebRTC 交付”的混合模式已成为标准，平衡了效率和兼容性。

#### 4. **未来展望**
尽管 RTMP 使用在下降，但预计到 2030 年，它仍将作为推流备用协议存在，尤其在遗留系统中。 新协议如 WHIP（WebRTC-HTTP Ingestion Protocol）正挑战其地位，提供更无缝的 WebRTC 推流。 如果你是开发者，建议在推流端保留 RTMP 支持，同时优先 HLS/WebRTC 用于分发，以适应 2025 年的浏览器生态。